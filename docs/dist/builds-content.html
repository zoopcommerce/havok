<!-- Subhead
================================================== -->
<header class="jumbotron subhead" id="overview">
  <div class="container">
    <h1>Builds</h1>
    <p class="lead">Make your production code fast, really fast</p>
  </div>
</header>


  <div class="container">

    <!-- Docs nav
    ================================================== -->
    <div class="row">
      <div class="span3 bs-docs-sidebar">
        <ul data-dojo-type="havok/widget/NavList"
            data-dojo-mixins="havok/widget/_AffixMixin, havok/widget/_ScrollSpyMixin"
            data-dojo-props="
               linkTemplate: '&lt;a role=&quot;navitem&quot; href=&quot;${href}&quot;&gt;&lt;i class=&quot;icon-chevron-right&quot;&gt;&lt;/i&gt; ${text}&lt;/a&gt;',
               viewportOffset: {top: 40, bottom: 0},
               affixTarget: 'mainContent',
               spyTarget: 'mainContent'
            "
            class="nav-stacked bs-docs-sidenav"
        >
        </ul>
      </div>
    <div class="span9" id="mainContent">

        
        <section id="overview" title="Overview">
          <div class="page-header">
            <h1>Overview</h1>
          </div>

          <p>Havok uses dojo's AMD loader to load modules, and has a handy ability to compile less client side. This makes development, unit testing and code reuse easy. However, it makes sites slow. An average havok page might load over 60 separate javascript files, and compile 15 less files. All those requests take too long for a production environment.</p>

          <p>Havok can utilize the dojo build system to create layers. Each layer consists of three parts:</p>

          <ul>
              <li>A single compressed javascript file containing many AMD modules</li>
              <li>Locale modules that contain translations for the layer</li>
              <li>A compressed css file that contains all the compiled less for the layer</li>
          </ul>

          <p>To build havok layers you will require:
          <ul>
              <li>node.js installed</li>
              <li>a buildconfig.js that sets up the build environment</li>
              <li>a profile.js that describes what should be built</li>
          </ul>

          <p>Furthermore, the havok build process has two parts:</p>
          <ul>
              <li>build profile preprocess</li>
              <li>the actual build</li>
          </ul>

        </section>

        <section id="build-config" title="Build Config">
          <div class="page-header">
            <h1>Build Config</h1>
          </div>

          <p>A <code>buildconfig.js</code> sets up dojo to run in the node.js environment. It must describe all the packages that will be used during the build.</p>

          <p>If you are only building havok with none of your own custom modules, then you can use <code>havok/build/buildconfig.js</code> as is.</p>

          <p>If you have other packages, or your own custom modules you wish to include in your build, then copy <code>havok/build/buildconfig.js</code> and add your extra packages to the <code>packages</code> array.</p>

        </section>

        <section id="profile" title="Profile">
          <div class="page-header">
            <h1>Profile</h1>
          </div>

          <p>A build profile is a js file that describes which packages will be built, which modules should be in any layers, and <i>lots</i> of other switches that can be used to tailor your layer for a specific runtime environment.</p>

          <p>The most important aspect of defining a build profile is the layers. Each layer defines a single compressed js file with the included modules and their dependencies along with a compressed css file of all the less for that layer.</p>

          <p>Look in the <code>havok/build/profile</code> directory. There you will find a heavily commented example profile, as well as the profile used to create the havok.js distributable.</p>

          <p>You can build the example profile by executing <code>sh build-example.sh</code> in the <code>havok/build</code> directory.</p>
        </section>

        <section id="preprocessor" title="Preprocessor">
          <div class="page-header">
            <h1>Preprocessor</h1>
          </div>

          <p>Havok inculdes a build profile preprocessor. The preprocessor will modify your build profile so havok's build features work.</p>

          <p>It will add havok build time plugin resolvers to your profile.</p>

          <p>It will merge your dojo config (including the shared di config) into your profile, so that config merge doesn't happen at run time.</p>

          <p>It will change the <code>writeAMD</code> transform to support compiling less for you layers.</p>

          <p>To run the preprocessor use:</p>

          <code>node havok/build/buildconfig.js load=havok/build/preprocess --profile path/to/your.profile.js</code>

          <p>The preprocessor will output a new modified profile called <code>your.profile.preprocessed.js</code></p>
          
          </section>

        <section id="build" title="Build">
          <div class="page-header">
            <h1>Build</h1>
          </div>

          <p>Run the build with:</p>

          <code>node havok/build/buildconfig.js load=build --profile path/to/your.profile.preprocessed.js</code>

          <p>Check the <code>build-report.text</code> to see any build errors and the exact content of your layers.</p>

        </section>

        <section id="deploy" title="Depoly">
          <div class="page-header">
            <h1>Deploy</h1>
          </div>

            <p>Place the following in your <code>head</code> tag to use your built dojo layers:</p>

<pre class="prettyprint linenums">
&lt;link rel=&quot;stylesheet&quot; href=&quot;path/to/layer.css&quot;&gt;
&lt;script src=&quot;path/to/bootable/layer.js&quot;&gt;&lt;/script&gt;
</pre>
            <p>Note: these docs use a bootable havok layer. Take a look at the source to see.</p>
        </section>
      </div>
    </div>

  </div>
